document.addEventListener("DOMContentLoaded",o());let c;let r;function o(){w();oe();if(sessionStorage.getItem("date")===null)d();if(sessionStorage.getItem("i")===null)sessionStorage.setItem("i","0");n().then(()=>{m();f();if(!document.getElementById("containerFooter")){p()}});X();u(false);let e=document.getElementById("logoMashorca");let t=document.getElementById("inicio");e.onclick=x;t.onclick=x}async function n(){try{const n=["edificios.json","https://www.descobreixteatre.com/assets/json/Teatre.json","https://www.mallorkcultura.com/json/museosMallorkCultura.json"];let t=[];let o=[];for(let e=0;e<n.length;e++){t[e]=await fetch(n[e]);o[e]=await t[e].json()}r=[];i(o[0]);l(o[1]);a(o[2])}catch(e){console.error("Error al cargar el archivo JSON:",e)}}function i(e){let t=e.itemListElement;t.forEach(function(e){let t={t:e.name,o:e.description.alternativeHeadline,i:e.description.description,l:e.description.genre,u:s(e.openingHours),m:e.image,p:e.subjectOf.p,g:e.subjectOf.g,h:e.geo.latitude,v:e.geo.longitude,url:e.url,S:e.aggregateRating.ratingCount,k:e.k,F:e.F};r.push(t)})}function l(e){let s="https://www.descobreixteatre.com/";let t=e.itemListElement;t.forEach(function(a){if(a.address.addressRegion==="Mallorca"){let o=a.geo.latitude;let n=a.geo.longitude;let i=a.name;let l=a.address.addressLocality;let e=a.event;e.forEach(function(e){let t={t:e.name+" ("+l+")",o:i,i:e.description,m:s+a.image.contentUrl,p:"",g:"",h:o,v:n,k:false,I:e.startDate,F:true};if(e.additionalProperty[0].value)t.p=s+e.additionalProperty[0].url;r.push(t)})}})}function a(e){e.servicios.forEach(function(e){let t=e.areaServed;let o={t:t.name,i:t.description,u:s(t.openingHours),m:t.photo[0].contentUrl,h:t.geo.latitude,v:t.geo.longitude,url:t.url,k:t.k,F:true};r.push(o)})}function s(e){const l=["Mo","Tu","We","Th","Fr","Sa","Su"];const a=["Lu","Ma","Mi","Ju","Vi","Sa","Do"];const s=[];if(e===undefined)return undefined;if(!Array.isArray(e))e=[e];e.forEach(function(e){const t=e.split(" ")[0].split("-");const o=e.split(" ")[1].split("-");let n=l.indexOf(t[0]);let i=l.indexOf(t[t.length-1]);if(n>i){i+=7}for(let t=0;t<7;t++){let e=a[t];if(t>=n&&t<=i){s.push(`${e}$${o[0]} - ${o[1]}`)}}});return s}function d(){let e=new Date;let t=e.getFullYear();let o=String(e.getMonth()+1).padStart(2,"0");let n=String(e.getDate()).padStart(2,"0");sessionStorage.setItem("date",`${t}-${o}-${n}`)}function u(e){let t=document.getElementById("portfolioNav");if(e)t.setAttribute("hidden","true");else t.removeAttribute("hidden")}function m(){let e=document.getElementById("portfolioContainer");let t=document.createElement("div");t.classList.add("text-center");let o=document.createElement("h2");o.classList.add("section-heading","text-uppercase");o.textContent="Conoce los lugares más emblemáticos de la isla";let n=document.createElement("h3");n.classList.add("section-subheading","text-muted");n.textContent="Aprende sobre los atractivos culturales de la isla";t.appendChild(o);t.appendChild(n);e.appendChild(t);let i=document.createElement("div");i.classList.add("row");e.appendChild(i);let l=0;r.forEach(function(o){if(l<6){let e="";if(o?.o!==undefined)e=o.o;let t=`
                <div class="col-lg-4 col-sm-6 mb-4">
                    <div class="portfolio-item">
                        <a class="portfolio-link" data-bs-toggle="modal" href="#portfolioModal${l}">
                            <div class="portfolio-hover">
                                <div class="portfolio-hover-content"><i class="fas fa-plus fa-3x"></i></div>
                            </div>
                            <img class="img-fluid" src="${o.m}" alt="..." loading="lazy"/>
                        </a>
                        <div class="portfolio-caption">
                            <div class="portfolio-caption-heading">${o.t}</div>
                            <div class="portfolio-caption-subheading text-muted">${e}</div>
                        </div>
                    </div>
                </div>
            `;i.innerHTML+=t;l++}});g()}function f(){let e=document.getElementById("team");let t=document.createElement("div");t.classList.add("container");t.id="teamContainer";let o=document.createElement("div");o.classList.add("text-center");let n=document.createElement("h2");n.classList.add("section-heading","text-uppercase");n.textContent="Nuestro Equipo";let i=document.createElement("h3");i.classList.add("section-subheading","text-muted");i.textContent="Trabajando por el interés cultural de Mallorca.";o.appendChild(n);o.appendChild(i);let l=document.createElement("div");l.classList.add("row");let a=[{t:"Eduardo Osuna",M:"Diseñador Jefe",m:"assets/img/team/edu.webp",P:["","https://www.instagram.com/cristiano",""]},{t:"Santiago Rattenbach",M:"Desarrollador Jefe",m:"assets/img/team/santi.webp",P:["","https://www.instagram.com/sergioliver__",""]},{t:"Jorge",M:"Director de Marketing",m:"assets/img/team/gejor.webp",P:["https://academic.uib.es/doa/consultaPublica/look%5bconpub%5dMostrarPubGuiaDocAs?entradaPublica=true&idiomaPais=es.ES&_anoAcademico=2023&_codAsignatura=21755","","https://es.linkedin.com/in/albertsalomvanrell?trk=people-guest_people_search-card"]}];a.forEach(function(e){let t=`
            <div class="col-lg-4">
                <div class="team-member">
                    <img class="mx-auto rounded-circle" src="${e.m}" alt="..." loading="lazy" />
                    <h4>${e.t}</h4>
                    <p class="text-muted">${e.M}</p>
                    <button class="btn btn-dark btn-social mx-2" aria-label="${e.t} Twitter Profile"><i class="fab fa-twitter"></i></button>
                    <button class="btn btn-dark btn-social mx-2" aria-label="${e.t} Facebook Profile"><i class="fab fa-facebook-f"></i></button>
                    <button class="btn btn-dark btn-social mx-2" aria-label="${e.t} LinkedIn Profile"><i class="fab fa-linkedin-in"></i></button>
                </div>
            </div>
        `;l.innerHTML+=t});let s=document.createElement("div");s.classList.add("row");let r=document.createElement("div");r.classList.add("col-lg-8","mx-auto","text-center");let d=document.createElement("p");d.classList.add("large","text-muted");d.textContent="Nuestro equipo está formado por unos ávidos estudiantes de ingeniería informática motivados por las artes y la cultura de nuestra isla y Jorge.";r.appendChild(d);s.appendChild(r);t.appendChild(o);t.appendChild(l);t.appendChild(s);e.appendChild(t);let c=document.getElementById("main");c.appendChild(e);let u=Array.from(document.querySelectorAll(".btn.btn-dark.btn-social.mx-2"));a.forEach((e,n)=>{e.P.forEach((e,t)=>{let o=u[n*3+t];if(e!==""&&o){o.onclick=function(){window.open(e)}}})})}function p(){let e=document.getElementById("contact");e.removeAttribute("hidden");let t=document.getElementById("footer");t.innerHTML=`
    <div class="container" id="containerFooter">
        <div class="row align-items-center">
            <div class="col-lg-4 text-lg-start" id="Copyright"></div>
            <div class="col-lg-4 my-3 my-lg-0">
                <button class="btn btn-dark btn-social mx-2" href="#!" aria-label="Twitter"><i class="fab fa-twitter"></i></button>
                <button class="btn btn-dark btn-social mx-2" href="#!" aria-label="Facebook"><i class="fab fa-facebook-f"></i></button>
                <button class="btn btn-dark btn-social mx-2" href="#!" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></button>
            </div>
            <div class="col-lg-4 text-lg-end">
                <a class="link-dark text-decoration-none me-3" href="#!">Política de Privacidad</a>
                <a class="link-dark text-decoration-none" href="#!">Términos de Uso</a>
            </div>
        </div>
    </div>`;let o=new Date(sessionStorage.getItem("date"));document.getElementById("Copyright").innerHTML="Copyright &copy; Mallorca Route "+o.getFullYear()}function g(){let i=document.getElementById("portfolio-modals");let l=0;r.forEach(function(e){b(i,e,l);let t=document.getElementById("hourIn"+l);let o=document.getElementById("hourOut"+l);function n(e){let t=document.getElementById("botonAgregar"+e);let o=document.getElementById("hourIn"+e);let n=document.getElementById("hourOut"+e);if(o.value&&n.value&&o.value<n.value){t.disabled=false}else{t.disabled=true}}(function(e){t.addEventListener("change",function(){n(e)});o.addEventListener("change",function(){n(e)});n(e)})(l);l++});i.removeAttribute("hidden")}function b(e,t,o){let n=document.createElement("div");n.classList.add("portfolio-modal","modal","fade");n.id="portfolioModal"+o;n.setAttribute("tabindex","-1");n.setAttribute("role","dialog");n.setAttribute("aria-hidden","true");n.addEventListener("hide.bs.modal",function(){const e=n.querySelector("video");const t=n.querySelector("audio");if(e){e.pause();e.currentTime=0}if(t){t.pause();t.currentTime=0}});let i=h(t,o);n.appendChild(i);e.appendChild(n)}function h(e,t){let o=document.createElement("div");o.classList.add("modal-dialog","d-flex","justify-content-center");let n=document.createElement("div");n.classList.add("modal-content");o.appendChild(n);let i=document.createElement("div");i.classList.add("close-modal");i.setAttribute("data-bs-dismiss","modal");let l=document.createElement("img");l.setAttribute("src","assets/img/close-icon.svg");l.setAttribute("alt","Close modal");l.setAttribute("loading","lazy");i.appendChild(l);n.appendChild(i);let a=document.createElement("div");a.classList.add("container");n.appendChild(a);let s=document.createElement("div");s.classList.add("row","justify-content-center");a.appendChild(s);let r=document.createElement("div");r.classList.add("col-lg-8");s.appendChild(r);let d=v(e,t);r.appendChild(d);return o}function v(n,e){let o=document.createElement("div");o.setAttribute("id","modalBody"+e);o.classList.add("modal-body");let t=document.createElement("h2");t.classList.add("text-uppercase");t.textContent=n.t;o.appendChild(t);if(n?.o!==undefined&&n.o!==""){let e=document.createElement("p");e.classList.add("item-intro","text-muted","mt-2","mb-4");e.textContent=n.o+".";o.appendChild(e)}if(n?.p===undefined||n?.p===""){let e=document.createElement("img");e.classList.add("img-fluid","d-block","mx-auto","video_popUp");e.setAttribute("loading","lazy");e.setAttribute("src",n.m);e.setAttribute("alt",n.t);o.appendChild(e)}else{let e=document.createElement("video");e.classList.add("img-fluid","d-block","mx-auto","video_popUp");e.setAttribute("loading","lazy");e.setAttribute("src",n.p);e.setAttribute("preload","metadata");e.setAttribute("alt",n.t);e.setAttribute("controls","true");o.appendChild(e)}if(n?.g!==undefined&&n?.g!==""){let e=document.createElement("audio");e.classList.add("d-block","mx-auto","mb-4","mt-2");e.setAttribute("src",n.g);e.setAttribute("controls","true");e.setAttribute("loading","lazy");o.appendChild(e)}if(n?.l!==undefined){let e=document.createElement("div");e.classList.add("list-inline-item","my-3");let t=document.createElement("strong");t.innerHTML="Estilo:";e.appendChild(t);e.innerHTML+=" "+n.l;o.appendChild(e)}let i=document.createElement("div");i.classList.add("d-flex","justify-content-center");o.appendChild(i);let l=document.createElement("button");l.classList.add("btn","btn-primary","mb-4","mt-2","text-center","px-4","py-3","fw-bolder");l.style.fontFamily="Montserrat";l.setAttribute("data-bs-toggle","collapse");l.setAttribute("data-bs-target","#descripcion"+e);l.textContent="Descripción"+" ↓";i.appendChild(l);l.onclick=function(){if(l.textContent.includes("↓")){l.textContent="Descripción"+" ↑"}else{l.textContent="Descripción"+" ↓"}};let a=document.createElement("p");a.id="descripcion"+e;a.textContent=n.i;a.classList.add("collapse");o.appendChild(a);let s=document.createElement("div");s.setAttribute("hidden","true");s.classList.add("mb-4","listaHorizontal");let r=document.createElement("div");r.setAttribute("id","clima");r.classList.add("d-flex","justify-content-center");let d=0;let c=new Date(sessionStorage.getItem("date")).getDate()-(new Date).getDate();if(c<=0){c=0;d=(new Date).getHours();do{d++}while(d%3!==0)}for(let o=0;d<24;d=d+3,o++){let e=n.h;let t=n.v;y(e,t,d,o+8*c).then(e=>{r.appendChild(e);if(s.getAttribute("hidden")){s.removeAttribute("hidden")}})["catch"](e=>{console.log(e)})}s.appendChild(r);o.appendChild(s);let u=document.createElement("div");u.classList.add("row");let m=F(e);u.appendChild(m);let f=document.createElement("div");f.classList.add("col-6","d-flex","justify-content-end");let p=document.createElement("div");p.classList.add("d-flex","justify-content-start","row");let g=document.createElement("ul");g.classList.add("list-inline");let b=document.createElement("li");b.classList.add("list-inline-item","row","col-4");let h=document.createElement("strong");h.textContent="Horarios:";b.appendChild(h);g.appendChild(b);let v=n?.u;if(v===undefined){let e=document.createElement("li");e.classList.add("list-inline-item","row");let t=document.createElement("div");t.classList.add("col-8");t.textContent="Permanentemente abierto";e.appendChild(t);g.appendChild(e)}for(let l in v){let e=v[l].split("$");let t=document.createElement("li");t.classList.add("list-inline-item","row");let o=document.createElement("div");o.classList.add("col-2");let n=document.createElement("strong");n.textContent=e[0]+": ";o.appendChild(n);t.appendChild(o);let i=document.createElement("div");i.classList.add("col-10");i.textContent=e[1];t.appendChild(i);g.appendChild(t)}p.appendChild(g);f.appendChild(p);u.appendChild(f);o.appendChild(u);let S=document.createElement("div");S.classList.add("button-group");let x=document.createElement("button");x.classList.add("btn","btn-primary","btn-xl","text-uppercase");x.setAttribute("type","button");x.setAttribute("id","botonAgregar"+e);x.setAttribute("data-bs-dismiss","modal");x.textContent="Añadir al plan";S.appendChild(x);if(j()){x.onclick=function(){if(sessionStorage.getItem("plan")===null||sessionStorage.getItem("plan")==="[]"){let e=document.getElementById("ol_espacioLista");e.innerHTML=""}k(e,n.t);_(parseInt(sessionStorage.getItem("i"))-1,n.t,document.getElementById("hourIn"+e).value,document.getElementById("hourOut"+e).value)}}else{x.onclick=function(){k(e,n.t);window.location.href="#";I();O()}}let w=n?.url;if(w!==undefined){let e=document.createElement("button");e.classList.add("btn","btn-secondary","btn-xl","text-uppercase");e.setAttribute("type","button");e.onclick=function(){window.open(w)};e.textContent="Más información";S.appendChild(e)}o.appendChild(S);return o}function y(e,t,a,s){const o="1ff240de287dae93a6e61f1f4a04bf0a";let n=`https://api.openweathermap.org/data/2.5/forecast?lat=${e}&lon=${t}&appid=${o}&units=metric`;return new Promise((i,l)=>{fetch(n).then(e=>e.json()).then(e=>{let t=e.list[s].weather[0].icon;let o=e.list[s].main.temp;if(t===undefined||o===undefined){l("No hay datos sobre el clima disponibles a las"+a+" horas");return}let n=S(a,o,t);if(n===undefined){l("No se han podido obtener el item");return}i(n)})["catch"](e=>{console.error(e);l("Error al obtener los datos del clima")})})}function k(e,t){let o={j:parseInt(sessionStorage.getItem("i")),name:t,$:document.getElementById("hourIn"+e).value,O:document.getElementById("hourOut"+e).value};sessionStorage.setItem("i",o.j+1);let n=sessionStorage.getItem("plan");let i;if(n){i=JSON.parse(n);i.push(o)}else{i=[o]}sessionStorage.setItem("plan",JSON.stringify(i))}function S(e,t,o){t=Math.round(t);let n=document.createElement("div");n.classList.add("mx-3");let i=document.createElement("div");n.appendChild(i);let l=document.createElement("img");l.classList.add("img-weather");l.setAttribute("src","https://openweathermap.org/img/wn/"+o+"@4x.png");l.setAttribute("loading","lazy");i.appendChild(l);let a=document.createElement("p");a.classList.add("item-intro","text-muted","mb-0");if(e<10){a.textContent="0"+e+":00"}else{a.textContent=e+":00"}i.appendChild(a);let s=document.createElement("p");s.classList.add("item-intro","text-muted","mb-0");s.textContent=t+"°C";i.appendChild(s);return n}function F(e){let t=document.createElement("div");t.classList.add("col-6","d-flex","justify-content-start","align-items-center");let o=document.createElement("div");o.classList.add("hour-list");let n=document.createElement("div");n.classList.add("row","mb-4","d-flex","hour-group");let i=document.createElement("div");i.classList.add("d-flex","justify-content-start","align-items-center");let l=document.createElement("strong");l.textContent="Hora de Entrada:";i.appendChild(l);let a=document.createElement("div");a.classList.add("d-flex","justify-content-start","align-items-center");let s=document.createElement("input");s.classList.add("form-control-sm");s.setAttribute("id","hourIn"+e);s.setAttribute("type","time");s.setAttribute("placeholder","10:00");s.setAttribute("data-sb-validations","required");a.appendChild(s);n.appendChild(i);n.appendChild(a);o.appendChild(n);let r=document.createElement("div");r.classList.add("row","d-flex","hour-group");let d=document.createElement("div");d.classList.add("d-flex","justify-content-start","align-items-center");let c=document.createElement("strong");c.textContent="Hora de Salida:";d.appendChild(c);let u=document.createElement("div");u.classList.add("d-flex","justify-content-start","align-items-center");let m=document.createElement("input");m.classList.add("form-control-sm");m.setAttribute("id","hourOut"+e);m.setAttribute("type","time");m.setAttribute("placeholder","11:30");m.setAttribute("data-sb-validations","required");u.appendChild(m);r.appendChild(d);r.appendChild(u);o.appendChild(r);t.appendChild(o);return t}function x(){let e=document.getElementById("slider");if(e===null){M();let e=document.getElementById("header");e.classList.add("masthead");let t=document.getElementById("team");if(t.hasAttribute("hidden")){t.removeAttribute("hidden")}o()}}function w(){let e=document.getElementById("header");let t=document.createElement("div");t.classList.add("slider");t.setAttribute("id","slider");e.appendChild(t);let i=document.createElement("div");i.classList.add("swiper-wrapper");t.appendChild(i);let l=1;while(l<=3){let e=document.createElement("img");let t="assets/img/slider/imagen"+l;e.setAttribute("src",t+"-s.webp");let o=t+"-s.webp 300w, "+t+"-m.webp 768w,"+t+".webp 1501w";e.setAttribute("srcset",o);e.setAttribute("alt","Imagen slider "+l);if(l!=1){e.setAttribute("loading","lazy")}else{e.setAttribute("loading","eager")}let n=document.createElement("div");n.classList.add("swiper-slide");n.appendChild(e);i.appendChild(n);l++}let o=document.createElement("div");o.classList.add("container","containerSlider");t.appendChild(o);let n=document.createElement("div");n.classList.add("masthead-subheading");n.textContent="Diseña una ruta pensada únicamente para ti";o.appendChild(n);let a=document.createElement("div");a.classList.add("masthead-heading","text-uppercase");a.textContent="!Atrévete a conocer Mallorca!";o.appendChild(a);let s=document.createElement("button");s.classList.add("btn","btn-primary","btn-xl","text-uppercase");s.textContent="Planificar Ruta";s.onclick=function(){window.location.href="#";I();O()};o.appendChild(s)}function I(){u(true);P();let e=document.getElementById("portfolioContainer");e.innerHTML="";let t=document.getElementById("portfolio");t.classList.replace("portfolioContainer","planContainer");let o=document.getElementById("team");let n=document.getElementById("teamContainer");o.removeChild(n);if(!o.hasAttribute("hidden")){o.setAttribute("hidden","true")}let i=document.getElementById("portfolio-modals");i.innerHTML=""}function M(){let e=document.getElementById("portfolioContainer");e.innerHTML="";let t=document.getElementById("portfolio");t.classList.replace("planContainer","portfolioContainer");let o=document.getElementById("portfolio-modals");o.innerHTML=""}function P(){let e=document.getElementById("header");let t=document.getElementById("slider");if(t)e.removeChild(t);e.classList.remove("masthead")}function j(){return document.getElementById("ol_espacioLista")!=null}function O(){let e=document.getElementById("portfolioContainer");let t=document.createElement("div");t.classList.add("text-center","pt-5","pb-2");let o=document.createElement("h2");o.classList.add("section-heading","text-uppercase","mb-2");o.textContent="Construye tu ruta";let n=document.createElement("h3");n.classList.add("section-subheading","text-muted","mb-3");n.textContent="¡Organiza tu visita y no te quedes sin ver nada!";t.appendChild(o);t.appendChild(n);e.appendChild(t);let i=z();e.appendChild(i);let l=document.createElement("div");l.setAttribute("id","busqueda-container");let a=document.getElementById("barra");a.appendChild(l);R();V();T();let s=document.createElement("div");s.classList.add("row");e.appendChild(s);let r=Z();s.appendChild(r);G();E();let d=ee();s.appendChild(d);let c=sessionStorage.getItem("plan");if(c){let t=JSON.parse(c);for(let e=0;e<t.length;e++){_(t[e].j,t[e].name,t[e].$,t[e].O)}}}function z(){let e=document.createElement("div");e.classList.add("container","d-flex","align-items-center","mb-3");e.setAttribute("id","busqueda");let t=document.createElement("div");t.classList.add("d-block");e.appendChild(t);let o=document.createElement("button");o.classList.add("btn","btn-primary","me-4");o.setAttribute("id","calendar-button");o.textContent="Elegir día";t.appendChild(o);let n=document.createElement("svg");n.setAttribute("xmlns","http://www.w3.org/2000/svg");n.setAttribute("viewBox","0 0 24 24");n.setAttribute("width","24");n.setAttribute("height","24");n.setAttribute("fill","currentColor");let i=document.createElement("path");i.setAttribute("d","M6.75 0a.75.75 0 0 1 .75.75V3h9V.75a.75.75 0 0 1 1.5 0V3h2.75c.966 0 1.75.784 1.75 1.75v16a1.75 1.75 0 0 1-1.75 1.75H3.25a1.75 1.75 0 0 1-1.75-1.75v-16C1.5 3.784 2.284 3 3.25 3H6V.75A.75.75 0 0 1 6.75 0ZM21 9.5H3v11.25c0 .138.112.25.25.25h17.5a.25.25 0 0 0 .25-.25Zm-17.75-5a.25.25 0 0 0-.25.25V8h18V4.75a.25.25 0 0 0-.25-.25Z");n.appendChild(i);o.appendChild(n);let l=document.createElement("div");l.setAttribute("type","button");l.setAttribute("id","calendar-container");t.appendChild(l);let a=`
        <div class="input-group mb-3">
            <!-- Filtros -->
            <div class="dropdown">
                <button class="btn btn-primary dropdown-toggle me-2" data-bs-toggle="dropdown">Filtros</button>
                <form class="dropdown-menu" id="filtros-busqueda">
                    <div class="dropdown-item filtro d-flex">
                        <div class="col-6 d-flex justify-content-start align-items-center me-2">
                            <label>Hora de Inicio:</label>
                        </div>
                        <div class="col-6 d-flex justify-content-start">
                            <input class="form-control-sm" id="SearchHourStart" type="text" placeholder="10:00" data-sb-validations="required" />
                        </div>
                    </div>
                    <div class="dropdown-item filtro d-flex">
                        <div class="col-6 d-flex justify-content-start align-items-center me-2">
                            <label>Hora de Fin:</label>
                        </div>
                        <div class="col-6 d-flex justify-content-start">
                            <input class="form-control-sm"  id="SearchHourEnd" type="text" placeholder="11:30" data-sb-validations="required" />
                        </div>
                    </div>
                    <div class="dropdown-item filtro d-flex">
                        <div class="col-6 d-flex justify-content-start align-items-center me-2">
                            <label>Distancia máxima (km):</label>
                        </div>
                        <div class="col-6 d-flex justify-content-start">
                            <input class="form-control-sm"  id="SearchRadius" type="text" placeholder="10" data-sb-validations="required" />
                        </div>
                    </div>
                    <div class="dropdown-item filtro d-flex">
                        <div class="col-6 d-flex justify-content-start align-items-center me-2">
                            <label>Actividad gratuita:</label>
                        </div>
                        <div class="col-6 d-flex justify-content-start align-items-center">
                            <input class="form-check-input" type="checkbox" id="SearchFree">
                        </div>
                    </div>
                    <div class="dropdown-item filtro d-flex">
                        <div class="col-6 d-flex justify-content-start align-items-center me-2">
                            <label>Parking cercano:</label>
                        </div>
                        <div class="col-6 d-flex justify-content-start align-items-center">
                            <input class="form-check-input" type="checkbox" id="ParkingNear">
                        </div>
                    </div>
                    <div class="dropdown-item d-flex justify-content-center">
                        <button class="btn btn-light" id="botonFiltros">Aplicar Filtros</button>
                    </div>
                </form>
            </div>
            <!-- Barra de búsqueda -->
            <input type="text" class="form-control" id="barra" placeholder="Buscar..." aria-label="Buscar" aria-describedby="SearchButton">
            <button class="btn btn-primary" type="submit" id="SearchButton">
                <i class="fas fa-search"></i>
            </button>
        </div>
        `;e.innerHTML+=a;return e}function C(e){if(!J(e)){alert("No se ha encontrado ningún edificio con ese nombre");return}sessionStorage.setItem("mapSelectedPlace",e);H();N();let t=document.getElementById("mapSelectedPlace");t.scrollIntoView({behavior:"smooth",C:"center"})}function E(){let e=document.getElementById("SearchButton");e.onclick=function(){let e=document.getElementById("barra").value;C(e)}}function t(o){let n=document.createElement("div");n.classList.add("container","d-flex","flex-column","align-items-center","mb-3");n.setAttribute("id","searchResults");for(let t=0;t<o.length;t++){if(D(o[t])){let e=document.createElement("div");e.classList.add("d-flex","justify-content-center","align-items-center","mb-2");e.setAttribute("id","resultado"+t);e.textContent=o[t].t;n.appendChild(e)}}return n}function J(t){for(let e=0;e<r.length;e++){if(r[e].t===t){return true}}return false}function B(){const t=new Set;r.forEach(e=>t.add(e.t));return[...t]}function T(){let e=document.getElementById("barra");$(e).autocomplete({source:B(),open:function(){$(".ui-autocomplete").addClass("search-z-index")}})}function V(){let n=false;let i=$("#calendar-container");if(i.length===0){console.error("No se ha encontrado el contenedor del calendario");return}i.hide();i.datepicker({A:0,D:"yy-mm-dd",N:function(o){if(o!=sessionStorage.getItem("date")){let e=confirm("¿Quieres cambiar la fecha del plan?\n\nFecha actual: "+sessionStorage.getItem("date"));if(e){sessionStorage.setItem("date",o);let e=document.getElementById("diaLista");e.textContent="Día "+o;let t=q(sessionStorage.getItem("mapSelectedPlace"));if(t?.I!==undefined){Y()}else{let e=document.getElementById("portfolioModal0");if(e!==null){H()}}N();i.hide();n=false}else{i.datepicker("setDate",sessionStorage.getItem("date"))}}}});let e=$("#calendar-button");e.click(function(){if(!n){i.show();n=true}else{i.hide();n=false}});$(document).mouseup(function(e){let t=$("#calendar-container");if(!t.is(e.target)&&t.has(e.target).length===0){t.hide()}})}function R(){let t=document.getElementById("SearchHourStart");let o=document.getElementById("SearchHourEnd");let n=document.getElementById("SearchFree");let i=document.getElementById("ParkingNear");let e=document.getElementById("botonFiltros");let l=document.getElementById("SearchRadius");e.onclick=function(e){e.preventDefault();sessionStorage.setItem("hourInFiltros","");sessionStorage.setItem("hourOutFiltros","");if(l.value!==""){sessionStorage.setItem("distanciaFiltros",l.value)}else{sessionStorage.setItem("distanciaFiltros","0")}U(t.value,o.value);sessionStorage.setItem("searchFree",""+n.checked);sessionStorage.setItem("parkingNear",""+i.checked);N()};sessionStorage.setItem("hourInFiltros","");sessionStorage.setItem("hourOutFiltros","");sessionStorage.setItem("distanciaFiltros","0");sessionStorage.setItem("searchFree","false");sessionStorage.setItem("parkingNear","false")}function U(i,l){if(e(i)&&e(l)){let o=i.split(":");let n=l.split(":");let e=parseInt(o[0]);let t=parseInt(n[0]);if(e<t){sessionStorage.setItem("hourInFiltros",i);sessionStorage.setItem("hourOutFiltros",l)}else if(e==t){let e=parseInt(o[1]);let t=parseInt(n[1]);if(e<t){sessionStorage.setItem("hourInFiltros",i);sessionStorage.setItem("hourOutFiltros",l)}}}}function e(e){try{let o=e.split(":");if(o.lenght===2){let e=parseInt(o[0]);let t=parseInt(o[1]);return e>=0&&e<24&&t>=0&&t<=60}return false}catch(t){return false}}function Z(){let e=document.createElement("div");e.classList.add("col-lg-8","col-sm-6","mb-4");e.setAttribute("id","mapContainer");let t=document.createElement("div");t.classList.add("mb-2","d-flex","justify-content-center");e.appendChild(t);let o=document.createElement("div");o.setAttribute("id","map");o.setAttribute("style","width: 600px; height: 400px;");t.appendChild(o);let n=`
        <!-- Selected From Map-->
        <div class="portfolio-item" id="mapSelectedPlace">
            <a class="portfolio-link" data-bs-toggle="modal" href="#portfolioModal0">
                <div id="popUpPortfolioHover" class="portfolio-hover" hidden="true">
                    <div class="portfolio-hover-content"><i class="fas fa-plus fa-3x"></i></div>
                </div>
                <img id="mapSelectedPlaceImg" class="img-fluid" src="" alt="Missing image..." hidden="true" loading="lazy"/>
            </a>
            <div class="portfolio-caption">
                <div class="portfolio-caption-heading" id="mapSelectedPlaceTitle">Busca tu destino</div>
                <div class="portfolio-caption-subheading text-muted" id="mapSelectedPlaceSubtitle">Puedes usar tanto la barra de búsqueda como el mapa</div>
            </div>
        </div>
        `;e.innerHTML+=n;return e}function G(){let e=parseFloat(sessionStorage.getItem("crd-latitude"));let t=parseFloat(sessionStorage.getItem("crd-longitude"));c=L.map("map").setView([e,t],10.5);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(c);let o=L.marker([39.59398458121737,2.678878006135083]).addTo(c);o.bindPopup("<b>Casa de Carlos</b><br>Dominio público.");A()}function A(){if(sessionStorage.getItem("distanciaFiltros")!=="0"){let e=L.circle([parseFloat(sessionStorage.getItem("crd-latitude")),parseFloat(sessionStorage.getItem("crd-longitude"))],{color:"blue",L:"#30f",fillOpacity:.1,H:parseInt(sessionStorage.getItem("distanciaFiltros"))*1e3}).addTo(c)}for(let e=0;e<r.length;e++){let t=r[e];if(t.h===undefined||t.v===undefined){console.error("El lugar "+t.t+" no tiene coordenadas")}else{if(D(t)){let e=L.marker([t.h,t.v]).addTo(c);e.on("click",function(){sessionStorage.setItem("mapSelectedPlace",t.t);H();N();let e=document.getElementById("mapSelectedPlace");e.scrollIntoView({behavior:"smooth",C:"center"})})}}}}function D(e){return(sessionStorage.getItem("searchFree")==="false"||e?.k===true)&&(sessionStorage.getItem("parkingNear")==="false"||e?.F===true)&&(sessionStorage.getItem("distanciaFiltros")==="0"||W(e.h,e.v)<=parseInt(sessionStorage.getItem("distanciaFiltros")))&&(sessionStorage.getItem("hourInFiltros")===""&&sessionStorage.getItem("hourOutFiltros")===""||Q(e))&&(e?.I===undefined||e?.I===sessionStorage.getItem("date"))}function Q(e){let a=sessionStorage.getItem("hourInFiltros");let s=sessionStorage.getItem("hourOutFiltros");let r=e.u;let d=(new Date(sessionStorage.getItem("date")).getDay()-1)%7;let c=false;let u=false;for(let l=0;l<r.length;l++){let e=r[l].split("$");let t=parseInt(e[0]);let o=e[1].split(" - ");let n=o[0].split(":");let i=o[1].split(":");if(t===d){if(a==""||parseInt(n[0])<parseInt(a)&&parseInt(n[0])<parseInt(s)){c=true}if(s==""||parseInt(i[0])>parseInt(a)&&parseInt(i[0])>parseInt(s)){u=true}}}return c&&u}function W(e,t){let o=parseFloat(sessionStorage.getItem("crd-latitude"));let n=parseFloat(sessionStorage.getItem("crd-longitude"));let i=e;let l=t;let a=6371;let s=(i-o)*Math.PI/180;let r=(l-n)*Math.PI/180;let d=Math.sin(s/2)*Math.sin(s/2)+Math.cos(o*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);let c=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d));let u=a*c;return u}function N(){K();A()}function K(){let e=document.querySelector(".leaflet-marker-pane");let t=document.querySelector(".leaflet-shadow-pane");let o=document.querySelector(".leaflet-popup-pane");e.innerHTML="";t.innerHTML="";o.innerHTML="";let n=document.querySelector(".leaflet-overlay-pane");if(n){let e=n.querySelectorAll("path");e.forEach(function(e){e.remove()})}}function X(){let e={q:true,timeout:5e3,_:0};function t(e){let t=e.coords;sessionStorage.setItem("crd-latitude",""+t.latitude);sessionStorage.setItem("crd-longitude",""+t.longitude)}function o(){console.error("No se ha podido obtener la ubicación del usuario");sessionStorage.setItem("crd-latitude","39.59398458121737");sessionStorage.setItem("crd-longitude","2.678878006135083")}navigator.geolocation.getCurrentPosition(t,o,e)}function Y(){let e=document.getElementById("popUpPortfolioHover");e.setAttribute("hidden","true");let t=document.getElementById("mapSelectedPlaceTitle");let o=document.getElementById("mapSelectedPlaceSubtitle");let n=document.getElementById("mapSelectedPlaceImg");t.innerHTML="Busca tu destino";o.innerHTML="Puedes usar tanto la barra de búsqueda como el mapa";n.setAttribute("hidden","true")}function H(){let e=document.getElementById("popUpPortfolioHover");if(e.getAttribute("hidden"))e.removeAttribute("hidden");let t=document.getElementById("mapSelectedPlaceTitle");let o=document.getElementById("mapSelectedPlaceSubtitle");let n=document.getElementById("mapSelectedPlaceImg");if(n.getAttribute("hidden"))n.removeAttribute("hidden");let i=document.getElementById("portfolio-modals");i.innerHTML="";let l=sessionStorage.getItem("mapSelectedPlace");let a=q(l);t.innerText=l;if(a?.o===undefined)o.innerText="";else o.innerText=a?.o;n.setAttribute("src",a.m);c.setView([a.h,a.v],15);b(i,a,0);let s=document.getElementById("hourIn0");let r=document.getElementById("hourOut0");function d(){let e=document.getElementById("botonAgregar0");let t=document.getElementById("hourIn0");let o=document.getElementById("hourOut0");if(t.value&&o.value&&t.value<o.value){e.disabled=false}else{e.disabled=true}}s.addEventListener("change",function(){d()});r.addEventListener("change",function(){d()});d()}function q(e){let t=0;while(t<r.length-1&&r[t].t!==e){t++}return r[t]}function ee(){let e=document.createElement("div");e.classList.add("col-lg-4","col-sm-6","mb-4");let t=document.createElement("div");t.classList.add("d-flex","justify-content-center");e.appendChild(t);let o=document.createElement("h3");o.classList.add("section-heading","text-uppercase");o.setAttribute("id","diaLista");o.textContent="Día "+sessionStorage.getItem("date");t.appendChild(o);let n=document.createElement("ol");n.classList.add("espacioLista","list-group");n.setAttribute("id","ol_espacioLista");if(sessionStorage.getItem("plan")===null||sessionStorage.getItem("plan")==="[]"){let e=document.createElement("div");e.classList.add("text-center","text-muted","mt-3","me-3","ms-3","fs-5");e.setAttribute("id","aventura");e.textContent="Aquí se mostrarán los destinos de tu próxima aventura...";n.appendChild(e)}e.appendChild(n);return e}function _(e,t,o,n){let i=document.getElementById("ol_espacioLista");let l=document.createElement("li");l.classList.add("list-group-item");l.setAttribute("id","li_espacioLista"+e);let a;if(o!=""&&n!=""){a=o+" - "+n+":"}else{a="N/A"}if(t===undefined){t="N/A"}else{l.onclick=function(){window.location.href="#portfolioModal0"};l.style.cursor="pointer"}let s=`
        <div class="col-8"> 
            <strong> ${a} </strong> ${t}
        </div>
        `;l.innerHTML+=s;let r=document.createElement("div");r.classList.add("col-4","d-flex","justify-content-end");let d=document.createElement("button");d.classList.add("btn","btn-secondary");d.innerHTML+='<i class="fa-solid fa-trash"></i>';d.onclick=function(){te(e)};r.appendChild(d);l.appendChild(r);i.appendChild(l);l.onclick=function(){C(t)}}function te(o){let e=document.getElementById("ol_espacioLista");let t=document.getElementById("li_espacioLista"+o);e.removeChild(t);let n=sessionStorage.getItem("plan");if(n){let e=JSON.parse(n);let t=0;while(t<e.length&&e[t].j!=o)t++;if(t<e.length)e.splice(t,1);sessionStorage.setItem("plan",JSON.stringify(e))}}function oe(){var e=new Swiper(".slider",{loop:true,speed:2e3,autoplay:{delay:8e3,J:false},keyboard:true})}